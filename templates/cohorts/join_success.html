{% extends 'base.html' %}

{% block title %}You're In! - Intentional Tech{% endblock %}

{% block content %}
<div class="content-centered">
    
    <hgroup>
        <h1>ðŸŽ‰ You're In!</h1>
        <p>Let's reclaim your attention.</p>
    </hgroup>

    <div class="card__stack">
        
        <!-- Next Steps -->
        <section class="card card--large">
            <h2>What Happens Next</h2>
            
            <ul>

            <li>
                <div>
                    <h4>ðŸ“Š Access Your Dashboard</h4>
                    <p>Start your first tasks at the Declutter Dashboard!</p>
                </div>
            </li>
            
            <li>
                <div style="width: 100%;">
                    <div for="email-reminder-toggle" style=" display: flex; justify-content: space-between; align-items: center;">
                        <strong>ðŸ“§ Optional: Turn on Email Reminders</strong>

                        <span class="list__meta">
                        <input type="checkbox" 
                                role="switch" 
                                id="email-reminder-toggle" 
                                {% if user.profile.email_daily_reminder %}checked{% endif %}
                                hx-post="{% url 'accounts_api:toggle_email_reminders' %}"
                                hx-trigger="change"
                                hx-swap="none"
                                hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                                hx-vals='js:{"daily_reminders": event.target.checked}'
                                hx-on:htmx:response-error="this.checked = !this.checked; showToast('Failed to update preference.', 'error')"
                                hx-on:htmx:send-error="this.checked = !this.checked; showToast('Network error. Please check your connection.', 'error')">
                    </span>

                    </div>
                    <p>Get gentle nudges for daily check-ins.</p>
                </div>
            </li>
            
            <li>
                <div>
                    <h4>ðŸš€ Daily Check-ins start on {{ cohort.start_date|date:"F j, Y" }}</h4>
                    <p>You can start exploring the dashboard now.</p>
                </div>
            </li>

            </ul>
        </section>

        <!-- Cohort Info -->
        <section class="card card--info card--large">
            <hgroup>
                <h3>Your Cohort</h3>
                <p>{{ cohort.name }}</p>
            </hgroup>
            <p>
                Starts <strong>{{ cohort.start_date|date:"F j, Y" }}</strong> â€¢ 
                Ends {{ cohort.end_date|date:"F j, Y" }}
            </p>
        </section>

        <!-- CTA -->
        <div>
            <a href="{% url 'cohorts:dashboard' %}" role="button">Go to Your Dashboard</a>
        </div>

        <!-- Footer -->
        <p>
            <small>
                <strong>Need help?</strong> Check out the 
                <a href="{% url 'core:protocol' %}">Protocol</a> page for guidance on how to make the most of your 30 days.
            </small>
        </p>

    </div>
</div>
{% endblock %}
