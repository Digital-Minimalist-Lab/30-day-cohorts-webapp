{% extends 'base.html' %}

{% block title %}{% if no_enrollment %}Welcome{% else %}Today's Tasks{% endif %} - Digital Minimalist Lab{% endblock %}

{% block content %}

{% if no_enrollment %}
    <!-- No enrollment state -->
    <header>
        <h1>Welcome to Digital Minimalist Lab</h1>
        <p>Ready to start your 30-day digital declutter?</p>
    </header>
    
    <section>
        <h2>Today's Tasks</h2>
        <article>
            {% if available_cohorts %}
                <p><a href="{% url 'cohorts:cohort_list' %}" role="button">Sign up for the next cohort</a></p>
            {% else %}
                <p><a href="{% url 'cohorts:cohort_list' %}" role="button">View available cohorts</a></p>
            {% endif %}
        </article>
    </section>

{% else %}
    <!-- Enrolled state -->
    <header>
        <h1>{{ cohort.name }}</h1>
    </header>
    
    <!-- Cohort Information -->
    <section>
        <p><small>{{ cohort.start_date|date:"F d, Y" }} – {{ cohort.end_date|date:"F d, Y" }}</small></p>
        <p><small>There are {{ enrollment_count }} people rethinking their digital habits with you!</small></p>
    </section>
    
    <!-- Tasks Section -->
    <section>
        <h2>Today's Tasks</h2>
        
        {% if tasks %}
            <!-- Vertical list of tasks -->
            {% for task in tasks %}
            <article style="margin-bottom: 1rem;">
                <h3><a href="{{ task.url }}">{{ task.title }}</a></h3>
                <p>{{ task.description|safe }}</p>
            </article>
            {% endfor %}
        {% else %}
            <!-- No tasks state -->
            <article>
                <p>There's nothing to do but seize the day!</p>
            </article>
        {% endif %}
    </section>
    
    <!-- Completed Tasks -->
    {% if completed_tasks %}
    <details>
        <summary>Completed Tasks ({{ completed_tasks|length }})</summary>
        <ul>
            {% for task in completed_tasks %}
            <li>
                <strong>{{ task.title }}</strong>
                <small>{{ task.completed_at|date:"M d, Y" }}</small>
            </li>
            {% endfor %}
        </ul>
    </details>
    {% endif %}
    
    <!-- Links -->
    <p>
        <small>
            <a href="{% url 'cohorts:submission_list' cohort_id=cohort.id survey_slug='daily-check-in' %}">View Past Check-Ins</a> •
            <a href="{% url 'cohorts:submission_list' cohort_id=cohort.id survey_slug='weekly-reflection' %}">View Past Reflections</a>
        </small>
    </p>

{% endif %}

{% endblock %}
