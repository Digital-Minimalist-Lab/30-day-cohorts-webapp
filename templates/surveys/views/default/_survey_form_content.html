<form method="post" novalidate>
    {% csrf_token %}
    <div>
        {% for section_name, items in form.get_fields_by_section %}
            {% if section_name %}
            <div class="survey-section">
                <h3 class="text-lg font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200">{{ section_name.title }}</h3>
                {% if section_name.description %}
                    <p class="survey-info-text">{{ section_name.description | safe }}</p>
                {% endif %}
            {% endif %}
            
            {% for item in items %}
                {% if item.is_info %}
                    {# Display-only info text #}
                    <p class="card card--info card--small card--accent-left-blue">
                        {{ item.text | safe }}
                    </p>
                {% else %}
                    {# Regular form field #}
                    {% with field=item.field %}

                        {% if field.field.widget.hide_label != True %}
                            <label for="{{ item.field.id_for_label }}">{{ field.label }}</label>
                        {% endif %}

                        {{ field }}

                        <!-- Errors -->
                        {% if field.errors %}
                            <small >
                            {{ field.errors|join:", " }}
                            </small>
                        {% endif %}


                        <!-- Help text -->
                        {% if field.help_text %}
                            <small>{{ field.help_text }}</small>
                        {% endif %}


                    {% endwith %}


                {% endif %}
            {% endfor %}
            
            {% if section_name %}
            </section>
            {% endif %}
        {% endfor %}
    </div>

    <div>
        <button type="submit">
            Submit Survey
        </button>
    </div>
</form>
